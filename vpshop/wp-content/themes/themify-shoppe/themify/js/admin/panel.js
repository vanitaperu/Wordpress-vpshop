let ThemifyPanel;((t,e,i,n)=>{"use strict";ThemifyPanel=class{constructor(i,n,s,a,o){this.el=i,this.vals=s,this.options=a,this.labels=o,this.nonce=n,this.bindings=new Map,this.topTabs();const r=new IntersectionObserver((async(i,n)=>{for(let s=i.length-1;s>-1;--s)if(!0===i[s].isIntersecting){n.unobserve(i[s].target);const a=i[s].target,o=e.createElement("div");o.className="tf_loader";try{if(a.classList.contains("ajax_select")){a.parentNode.after(o);const e=await t.fetch({action:a.dataset.ajaxAction,nonce:this.nonce},"html");a.firstChild?.remove(),a.appendChild(e)}else if(a.hasAttribute("data-codeditor")){await t.loadJs(t.url+"js/admin/modules/codemirror/codemirror",!!window.ThemifyCodeMiror);let e=new ThemifyCodeMiror(a,a.dataset.codeditor);await e.run()}}catch(t){}o.remove()}0===i.length&&n.disconnect()})),c=i.querySelectorAll(".ajax_select,[data-codeditor]");for(let t=c.length-1;t>-1;--t)r.observe(c[t])}getIcon(t,i){t="tf-"+t.trim().replace(" ","-");const n="http://www.w3.org/2000/svg",s=e.createElementNS(n,"use"),a=e.createElementNS(n,"svg");let o="tf_fa "+t;return i&&(o+=" "+i),a.setAttribute("class",o),s.setAttributeNS(null,"href","#"+t),a.appendChild(s),a}after(t){const i=e.createElement("div");return i.innerHTML=t,i.className="after",i}getHelp(t){const i=e.createElement("div"),n=e.createElement("i"),s=e.createElement("div");return n.appendChild(this.getIcon("ti-help")),n.tabIndex="-1",s.className="help_content tf_hide tf_box",s.innerHTML=t,i.className="help tf_rel",i.append(n,s),i}getDisabledMsg(t){const i=e.createElement("div");return"disabled"!==t&&(i.className="warning",i.innerHTML=t),i}binding(){if(this.bindings.size>0)for(let[t,e]of this.bindings){let i=this.el.querySelector("#"+t);if(i){let t=function(){let t,i,n={},s=this.closest("#main");if("SELECT"===this.tagName?n=e[this.value]||e.any:"checkbox"===this.type&&(n=this.checked?e.checked:e.not_checked),t=n.show,i=n.hide,t){Array.isArray(t)||(t=[t]);for(let e=t.length-1;e>-1;--e){let i=s.querySelector("."+t[e]);i&&(i.style.display="")}}if(i){Array.isArray(i)||(i=[i]);for(let t=i.length-1;t>-1;--t){let e=s.querySelector("."+i[t]);e&&(e.style.display="none")}}};t.call(i),i.tfOn("change",t,{passive:!0})}}this.bindings.clear()}topTabs(){const t=e.createDocumentFragment(),i=e.createDocumentFragment(),s=e.createDocumentFragment(),a=this.el.querySelector("#main"),o=e.createElement("ul");let r=new URL(window.location.href).searchParams.get("tab")||"";this.options[r]===n&&(r=Object.keys(this.options)[0]),o.className="top_tabs tf_overflow";for(let n in this.options){let a=e.createElement("li"),o=e.createElement("section"),c=e.createElement("input"),l=e.createElement("label");c.type="radio",c.name="tab",c.className="tab tf_hide",c.id=l.htmlFor="tab-"+n,l.append(this.getIcon(this.options[n].icon),e.createTextNode(this.options[n].label)),o.id="tab-"+n+"-content",o.className="content tf_hide",n===r&&(c.checked=!0),o.appendChild(this.render(this.options[n].options)),a.appendChild(l),i.appendChild(o),s.appendChild(c),t.appendChild(a)}this.el.tfOn("change",(t=>{const e=t.target&&"radio"===t.target.type&&t.target.classList.contains("tab")?t.target:null;if(e){const t=new URL(window.location.href);t.searchParams.set("tab",e.id.replace("tab-","")),history.replaceState(null,null,t)}}),{passive:!0}),o.appendChild(t),this.el.prepend(s),this.el.tfClass("header")[0].prepend(o),a.classList.add("tf_opacity"),a.appendChild(i),this.binding(),a.classList.remove("tf_opacity")}render(t){const i=e.createDocumentFragment();for(let s=0,a=t.length;s<a;++s){let a=e.createElement("div"),o=e.createElement("div"),r=t[s].id,c=t[s].type,l=t[s].label!==n,h=r!==n&&this.vals[r]!==n?this.vals[r]:t[s].def;if(a.className="field",o.className="field_input field_"+c,l){let i="checkbox"===c?Object.keys(t[s].options).length:0;r&&"radio"===c&&(r+="_"+Object.keys(t[s].options)[0]);let o=r?"label":"span",l=e.createElement(o),h="label"===o?e.createElement("div"):null;l.textContent=t[s].label,r&&(l.htmlFor=r),("group"===c||"radio"===c||i>1)&&(a.className+=" alig_top"),"group"===c&&r!==n&&(a.className+=" "+r),h&&(h.className="label",h.appendChild(l),l=h),t[s].help&&(l.appendChild(this.getHelp(t[s].help)),h||(l.className="label")),a.appendChild(l)}try{let e=this["text"===c||"number"===c||"email"===c||"url"===c||"hidden"===c?"input":c](t[s],h,c);l||"group"!==c?o.appendChild(e):(a.className+=" field_group",a.appendChild(e))}catch(t){}if(l||"group"!==c){if(!t[s].disabled&&t[s].desc){a.classList.add("alig_top");let i=e.createElement("div");i.className="description",i.innerHTML=t[s].desc,o.appendChild(i)}a.appendChild(o)}t[s].disabled&&(a.classList.add("alig_top","has_error"),o.appendChild(this.getDisabledMsg(t[s].disabled))),o.className+=" count_"+o.childElementCount,t[s].wrap_class&&(a.className+=" "+t[s].wrap_class),a.className+=" count_"+a.childElementCount,i.appendChild(a),t[s].bind&&r&&this.bindings.set(r,t[s].bind)}return i}select(t,i){const s=e.createElement("div"),a=e.createElement("select"),o=e.createDocumentFragment(),r=e.createDocumentFragment();if(s.className="tf_inline_b tf_vmiddle tf_rel",a.className="tf_scrollbar",t.class!==n&&(a.className+=" "+t.class),t.id&&(a.name=a.id=t.id),t.disabled?a.disabled=!0:i&&t.ajax&&(t.options={[i]:""}),t.options){for(let n in t.options){let s=e.createElement("option");s.value=n,s.text=t.options[n],n===i&&(s.selected=!0),r.appendChild(s)}a.appendChild(r)}return s.appendChild(a),o.appendChild(s),t.after&&o.appendChild(this.after(t.after)),t.ajax&&(a.className+=" ajax_select",a.dataset.ajaxAction=t.ajax),o}expand(t){const i=e.createElement("div");return i.className="expand",i.appendChild(this.render(t.options)),i}group(t){return this.render(t.options)}radio(t,i){const n=e.createDocumentFragment(),s=t.options;for(let a in s){let o=e.createElement("input"),r=e.createElement("label");o.type="radio",o.value=a,o.name=t.id,r.textContent=s[a],r.htmlFor=o.id=t.id+"_"+a,t.disabled?o.disabled=!0:a===i&&(o.checked=!0),n.append(o,r)}return t.after&&f.appendChild(this.after(t.after)),n}checkbox(t,i){const n=e.createDocumentFragment(),s=t.options;for(let a in s){let o=e.createElement("input"),r=e.createElement("label");o.type="checkbox",o.value=1,o.name=a,r.textContent=s[a],r.htmlFor=o.id=a+"_checkbox",t.disabled?o.disabled=!0:a===i&&(o.checked=!0),n.appendChild(o),s[a]&&n.appendChild(r)}return t.after&&n.appendChild(this.after(t.after)),n}input(t,i,n){const s=e.createDocumentFragment(),a=e.createElement("input");return t.disabled?a.disabled=!0:a.value=i??"",a.type=n||"text",t.id&&(a.name=t.id),"hidden"!==n&&(t.id&&(a.id=t.id),t.min||"number"===n||"range"===n?a.min=parseInt(t.min)||0:a.className="tf_w",t.max&&(a.max=~~t.max,a.defaultValue=a.value=i),t.step&&(a.step=t.step),t.placeholder&&(a.placeholder=t.placeholder)),t.class&&(a.className+=" "+t.class),s.appendChild(a),t.after&&s.appendChild(this.after(t.after)),s}textarea(t,i){const n=e.createDocumentFragment(),s=e.createElement("textarea");return s.id=s.name=t.id,s.className="tf_w",t.class&&(s.className+=" "+t.class),t.disabled?s.disabled=!0:s.value=i||"",n.appendChild(s),t.after&&n.appendChild(this.after(t.after)),t.codeditor&&(s.dataset.codeditor=t.codeditor),n}slider(t,i){const n=e.createDocumentFragment(),s=Object.assign(t);i||t.def||(i=t.max),delete s.after;const a=this.input(s,i,"number");delete s.id;const o=this.input(s,i,"range");n.append(o,a),t.after&&n.appendChild(this.after(t.after));for(let t=n.querySelectorAll("input"),e=t.length-1;e>-1;--e)t[e].tfOn("input change",(t=>{let e=t.currentTarget,i=parseInt(e.value),n=parseInt(e.min),s=parseInt(e.max),a=e.nextElementSibling||e.previousElementSibling;"change"===t.type&&(i>s||i<n)&&(i=i>s?s:n,e.value=i),a.value=i}),{passive:!0});return n}toggle(t,i){const n=e.createElement("label"),s=e.createElement("input"),a=e.createElement("div"),o=t.value||1;return s.className="toggle_switch",s.type="checkbox",s.id=s.name=t.id,s.value=o,t.disabled?s.disabled=!0:(t.opp&&(s.className+=" opposite"),s.checked=i==o),a.className="switch_label tf_rel tf_box",a.dataset.on=t.show||this.labels.en,a.dataset.off=t.hide||this.labels.dis,t.class&&(a.className+=" "+t.class),n.append(s,a),n}replace_url(n){const s=e.createDocumentFragment(),a=this.render([n.find]),o=this.render([n.replace]),r=e.createElement("button"),c=e.createElement("span"),l=n.confirm;return c.textContent=n.text,r.type="button",r.className="clear_cache find_replace",n.class&&(r.className+=" "+n.class),r.dataset.done=n.done,r.dataset.clearing=n.clearing,r.tfOn("click",(async e=>{if(confirm(l)){const n=e.currentTarget;if(!n.disabled){t.loadJs(t.url+"js/admin/notification",!!i.TF_Notification),n.disabled=!0;const s=n.tfTag("span")[0],a=n.closest(".field_replace_url").tfTag("input"),o=a[0].value.trim(),r=a[1].value.trim(),c=s.textContent;s.textContent=n.dataset.clearing,await t.loadJs(t.url+"js/admin/modules/find-replace",!!i.TF_Replace);try{await TF_Replace(o,r,this.nonce)}catch(e){}s.textContent=c,n.disabled=!1}}}),{passive:!0}).append(this.getIcon("ti-eraser"),c),s.append(a,o,r),s}clear_cache(n){const s=e.createDocumentFragment(),a=e.createElement("button"),o=e.createElement("span");if(o.textContent=n.text,a.className="clear_cache",a.type="button",n.class&&(a.className+=" "+n.class),a.dataset.action=n.action,a.dataset.done=n.done,a.dataset.clearing=n.clearing,s.appendChild(a),n.network){const t=e.createElement("div");t.className="clear_cache_network",t.appendChild(this.checkbox({options:n.network})),s.appendChild(t)}return n.after&&s.appendChild(this.after(n.after)),a.tfOn("click",(async e=>{const n=e.currentTarget,s=n.tfTag("span")[0],o=s.textContent;if(!n.disabled){s.textContent=n.dataset.clearing,n.disabled=!0,await t.loadJs(t.url+"js/admin/notification",!!i.TF_Notification),TF_Notification.show("info",n.dataset.clearing);try{const e=await t.fetch({nonce:this.nonce,action:n.dataset.action,all:a.parentNode.querySelector("input:checked")?1:0});if(!e.success)throw e;await TF_Notification.showHide("done",n.dataset.done,1500)}catch(e){const t=e.data?e.data:e;await TF_Notification.showHide("error",t)}s.textContent=o,n.disabled=!1}}),{passive:!0}).append(this.getIcon("ti-eraser"),o),s}}})(Themify,document,window,void 0);