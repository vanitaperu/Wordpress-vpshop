(($,t,i,o,s,n,r,c,e,a,l)=>{"use strict";function f(t){const i=t.parent();t.removeData("tfminicolors-initialized").removeData("tfminicolors-settings").removeProp("size").removeClass("tfminicolors-input"),i.before(t).remove()}function p(t){let s;try{s=i.top.document}catch(t){s=i.document}var n=t.parent(),r=n.find(".tfminicolors-panel"),c=t.data("tfminicolors-settings"),e=o.body.contains(t[0])?o:s;!t.data("tfminicolors-initialized")||t.prop("disabled")||n.hasClass("tfminicolors-inline")||n.hasClass("tfminicolors-focus")||(m(s),n.addClass("tfminicolors-focus"),r.animate?r.stop(!0,!0).fadeIn(c.showSpeed,(()=>{c.show&&c.show.call(t.get(0))})):(r.show(),c.show&&c.show.call(t.get(0))),$(e).on("mousedown.tfminicolors touchstart.tfminicolors",(function(t){1===t.which&&0===$(t.target).closest(".tfminicolors,.tfminicolors_wrapper").length&&($(this).off("mousemove.tfminicolors touchmove.tfminicolors mousedown.tfminicolors touchstart.tfminicolors mouseup.tfminicolors touchend.tfminicolors"),m(this),e=null)})))}function m(t){$(".tfminicolors-focus",t).each((function(){const t=$(this),i=t.find(".tfminicolors-input"),o=t.find(".tfminicolors-panel"),s=i.data("tfminicolors-settings");o.animate?o.fadeOut(s.hideSpeed,(()=>{s.hide&&s.hide.call(i.get(0)),t.removeClass("tfminicolors-focus")})):(o.hide(),s.hide&&s.hide.call(i.get(0)),t.removeClass("tfminicolors-focus"))}))}function h(t,i,o){let s,n,r,c,a,l=t.parents(".tfminicolors").find(".tfminicolors-input"),f=l.data("tfminicolors-settings"),p=t.find("[class$=-picker]"),{left:m,top:h}=t.offset(),d=e.round(i.pageX-m),b=e.round(i.pageY-h),g=o?f.animationSpeed:0;i.changedTouches&&(d=i.changedTouches[0].pageX-m,b=i.changedTouches[0].pageY-h),d<0&&(d=0),b<0&&(b=0),d>t.width()&&(d=t.width()),b>t.height()&&(b=t.height()),t.parent().hasClass("tfminicolors-slider-wheel")&&p.parent().hasClass("tfminicolors-grid")&&(s=75-d,n=75-b,r=e.sqrt(s*s+n*n),c=e.atan2(n,s),c<0&&(c+=2*e.PI),r>75&&(r=75,d=75-75*e.cos(c),b=75-75*e.sin(c)),d=e.round(d),b=e.round(b)),a={top:b+"px"},t.is(".tfminicolors-grid")&&(a.left=d+"px"),p.animate?p.stop(!0).animate(a,g,f.animationEasing,(()=>{u(l,t)})):(p.css(a),u(l,t))}function u(t,i){function o(t,i){return t.length&&i?{x:t.offset().left-i.offset().left+t.outerWidth()/2,y:t.offset().top-i.offset().top+t.outerHeight()/2}:null}let r,c,a,l,f,p,m,h=t.val(),u=t.attr("data-opacity"),b=t.parent(),w=t.data("tfminicolors-settings"),y=b.find(".tfminicolors-input-swatch"),_=b.find(".tfminicolors-grid"),v=b.find(".tfminicolors-slider"),x=b.find(".tfminicolors-opacity-slider"),C=_.find("[class$=-picker]"),z=v.find("[class$=-picker]"),S=x.find("[class$=-picker]"),F=o(C,_),T=o(z,v),N=o(S,x);if(i.is(".tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider")){switch(w.control){case"wheel":l=_.width()/2-F.x,f=_.height()/2-F.y,p=e.sqrt(l*l+f*f),m=e.atan2(f,l),m<0&&(m+=2*e.PI),p>75&&(p=75,F.x=69-75*e.cos(m),F.y=69-75*e.sin(m)),c=k(p/.75,0,100),r=k(180*m/e.PI,0,360),a=k(100-e.floor(T.y*(100/v.height())),0,100),h=j({h:r,s:c,b:a}),v.css("backgroundColor",j({h:r,s:c,b:100}));break;case"saturation":r=k(s(F.x*(360/_.width()),10),0,360),c=k(100-e.floor(T.y*(100/v.height())),0,100),a=k(100-e.floor(F.y*(100/_.height())),0,100),h=j({h:r,s:c,b:a}),v.css("backgroundColor",j({h:r,s:100,b:a})),b.find(".tfminicolors-grid-inner").css("opacity",c/100);break;case"brightness":r=k(s(F.x*(360/_.width()),10),0,360),c=k(100-e.floor(F.y*(100/_.height())),0,100),a=k(100-e.floor(T.y*(100/v.height())),0,100),h=j({h:r,s:c,b:a}),v.css("backgroundColor",j({h:r,s:c,b:100})),b.find(".tfminicolors-grid-inner").css("opacity",1-a/100);break;default:r=k(360-s(T.y*(360/v.height()),10),0,360),c=k(e.floor(F.x*(100/_.width())),0,100),a=k(100-e.floor(F.y*(100/_.height())),0,100),h=j({h:r,s:c,b:a}),_.css("backgroundColor",j({h:r,s:100,b:100}));break}u=w.opacity?n(1-N.y/x.height()).toFixed(2):1,d(t,h,u)}else y.find("span").css({backgroundColor:h,opacity:u}),g(t,h,u)}function d(t,i,o){let s,r=t.parent(),c=t.data("tfminicolors-settings"),e=r.find(".tfminicolors-input-swatch");c.opacity&&t.attr("data-opacity",o),"rgb"===c.format?(s=x(i)?_(i,!0):F(y(i,!0)),o=""===t.attr("data-opacity")?1:k(n(t.attr("data-opacity")).toFixed(2),0,1),!isNaN(o)&&c.opacity||(o=1),i=t.tfminicolors("rgbObject").a<=1&&s&&c.opacity?"rgba("+s.r+", "+s.g+", "+s.b+", "+n(o)+")":"rgb("+s.r+", "+s.g+", "+s.b+")"):(x(i)&&(i=z(i)),i=w(i,c.letterCase)),t.val(i),e.find("span").css({backgroundColor:i,opacity:o}),r.removeClass("tfminicolors-var-input"),g(t,i,o)}function b(t,i){let o,s,r,c,a,l,f,p;const m=t.parent(),h=t.data("tfminicolors-settings"),u=m.find(".tfminicolors-input-swatch"),d=m.find(".tfminicolors-grid"),b=m.find(".tfminicolors-slider"),S=m.find(".tfminicolors-opacity-slider"),T=d.find("[class$=-picker]"),N=b.find("[class$=-picker]"),I=S.find("[class$=-picker]"),E=t.val();x(E)?(o=z(E),r=k(n(C(E)).toFixed(2),0,1),r&&t.attr("data-opacity",r)):o=w(y(E,!0),h.letterCase),o||(o=w(v(h.defaultValue,!0),h.letterCase));const O=function(t){const i=function(t){var i={h:0,s:0,b:0},o=e.min(t.r,t.g,t.b),s=e.max(t.r,t.g,t.b),n=s-o;i.b=s,i.s=0!==s?255*n/s:0,i.h=0!==i.s?t.r===s?(t.g-t.b)/n:t.g===s?2+(t.b-t.r)/n:4+(t.r-t.g)/n:-1;i.h*=60,i.h<0&&(i.h+=360);return i.s*=100/255,i.b*=100/255,i}(F(t));0===i.s&&(i.h=360);return i}(o),R=h.keywords?$.map(h.keywords.split(","),(t=>$.trim(t.toLowerCase()))):[],D=""!==E&&0===E.indexOf("--");switch(""!==E&&(!0===D||$.inArray(E.toLowerCase(),R)>-1)?(c=w(E),!0===D&&m.addClass("tfminicolors-var-input")):(c=x(E)?_(E):o,m.removeClass("tfminicolors-var-input")),i||t.val(c),h.opacity&&(s=""===t.attr("data-opacity")?1:k(n(t.attr("data-opacity")).toFixed(2),0,1),isNaN(s)&&(s=1),t.attr("data-opacity",s),u.find("span").css("opacity",s),l=k(S.height()-S.height()*s,0,S.height()),I.css("top",l+"px")),"transparent"===E.toLowerCase()&&u.find("span").css("opacity",0),u.find("span").css("backgroundColor",o),h.control){case"wheel":f=k(e.ceil(.75*O.s),0,d.height()/2),p=O.h*e.PI/180,a=k(75-e.cos(p)*f,0,d.width()),l=k(75-e.sin(p)*f,0,d.height()),T.css({top:l+"px",left:a+"px"}),l=150-O.b/(100/d.height()),""===o&&(l=0),N.css("top",l+"px"),b.css("backgroundColor",j({h:O.h,s:O.s,b:100}));break;case"saturation":a=k(5*O.h/12,0,150),l=k(d.height()-e.ceil(O.b/(100/d.height())),0,d.height()),T.css({top:l+"px",left:a+"px"}),l=k(b.height()-O.s*(b.height()/100),0,b.height()),N.css("top",l+"px"),b.css("backgroundColor",j({h:O.h,s:100,b:O.b})),m.find(".tfminicolors-grid-inner").css("opacity",O.s/100);break;case"brightness":a=k(5*O.h/12,0,150),l=k(d.height()-e.ceil(O.s/(100/d.height())),0,d.height()),T.css({top:l+"px",left:a+"px"}),l=k(b.height()-O.b*(b.height()/100),0,b.height()),N.css("top",l+"px"),b.css("backgroundColor",j({h:O.h,s:O.s,b:100})),m.find(".tfminicolors-grid-inner").css("opacity",1-O.b/100);break;default:a=k(e.ceil(O.s/(100/d.width())),0,d.width()),l=k(d.height()-e.ceil(O.b/(100/d.height())),0,d.height()),T.css({top:l+"px",left:a+"px"}),l=k(b.height()-O.h/(360/b.height()),0,b.height()),N.css("top",l+"px"),d.css("backgroundColor",j({h:O.h,s:100,b:100}));break}t.data("tfminicolors-initialized")&&g(t,c,s)}function g(t,i,o){let s,n,c,e=t.data("tfminicolors-settings"),a=t.data("tfminicolors-lastChange");if(!a||a.value!==i||a.opacity!==o){if(t.data("tfminicolors-lastChange",{value:i,opacity:o}),e.swatches&&0!==e.swatches.length){for(s=x(i)?_(i,!0):F(i),n=-1,c=0;c<e.swatches.length;++c)if(s.r===e.swatches[c].r&&s.g===e.swatches[c].g&&s.b===e.swatches[c].b&&s.a===e.swatches[c].a){n=c;break}t.parent().find(".tfminicolors-swatches .tfminicolors-swatch").removeClass("selected"),-1!==n&&t.parent().find(".tfminicolors-swatches .tfminicolors-swatch").eq(c).addClass("selected")}e.change&&(e.changeDelay?(clearTimeout(t.data("tfminicolors-changeTimeout")),t.data("tfminicolors-changeTimeout",r((()=>{e.change.call(t.get(0),i,o)}),e.changeDelay))):e.change.call(t.get(0),i,o)),t.trigger("change").trigger("input")}}function w(t,i){return"uppercase"===i?t.toUpperCase():t.toLowerCase()}function y(t,i){return(t=t.replace(/^#/g,"")).match(/^[A-F0-9]{3,6}/gi)?3!==t.length&&6!==t.length?"":(3===t.length&&i&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t):""}function _(t,i){var o=t.replace(/[^\d,.]/g,"").split(",");return o[0]=k(s(o[0],10),0,255),o[1]=k(s(o[1],10),0,255),o[2]=k(s(o[2],10),0,255),o[3]!==a&&(o[3]=k(n(o[3],10),0,1)),i?o[3]!==a?{r:o[0],g:o[1],b:o[2],a:o[3]}:{r:o[0],g:o[1],b:o[2]}:o[3]!==a&&o[3]<=1?"rgba("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")":"rgb("+o[0]+", "+o[1]+", "+o[2]+")"}function v(t,i){return x(t)?_(t):y(t,i)}function k(t,i,o){return t<i?t=i:t>o&&(t=o),t}function x(t){const i=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return!(!i||4!==i.length)}function C(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===t.length?t[4]:"1"}function z(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+s(t[1],10).toString(16)).slice(-2)+("0"+s(t[2],10).toString(16)).slice(-2)+("0"+s(t[3],10).toString(16)).slice(-2):""}function S(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return $.each(i,((t,o)=>{1===o.length&&(i[t]="0"+o)})),"#"+i.join("")}function j(t){return S(function(t){var i={},o=e.round(t.h),s=e.round(255*t.s/100),n=e.round(255*t.b/100);if(0===s)i.r=i.g=i.b=n;else{var r=n,c=(255-s)*n/255,a=o%60*(r-c)/60;360===o&&(o=0),o<60?(i.r=r,i.b=c,i.g=c+a):o<120?(i.g=r,i.b=c,i.r=r-a):o<180?(i.g=r,i.r=c,i.b=c+a):o<240?(i.b=r,i.r=c,i.g=r-a):o<300?(i.b=r,i.g=c,i.r=c+a):o<360?(i.r=r,i.g=c,i.b=r-a):(i.r=0,i.g=0,i.b=0)}return{r:e.round(i.r),g:e.round(i.g),b:e.round(i.b)}}(t))}function F(t){return{r:(t=s(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}$.tfminicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom",show:null,showSpeed:100,theme:"default",swatches:[]}},$.extend($.fn,{tfminicolors(t,i){switch(t){case"destroy":return $(this).each((function(){f($(this))})),$(this);case"hide":return m(),$(this);case"opacity":return i===a?$(this).attr("data-opacity"):($(this).each((function(){b($(this).attr("data-opacity",i))})),$(this));case"rgbObject":return function(t){const i=$(t),o=i.attr("data-opacity"),s=i.val(),r=x(s)?_(s,!0):F(y(s,!0));if(!r)return null;o!==a&&$.extend(r,{a:n(o)});return r}($(this));case"rgbString":case"rgbaString":return function(t,i){const o=$(t),s=o.val(),r=x(s)?_(s,!0):F(y(s,!0));let c=o.attr("data-opacity");if(!r)return null;c===a&&(c=1);return i?"rgba("+r.r+", "+r.g+", "+r.b+", "+n(c)+")":"rgb("+r.r+", "+r.g+", "+r.b+")"}($(this),"rgbaString"===t);case"settings":return i===a?$(this).data("tfminicolors-settings"):($(this).each((function(){var t=$(this).data("tfminicolors-settings")||{};f($(this)),$(this).tfminicolors($.extend(!0,t,i))})),$(this));case"show":return p($(this).eq(0)),$(this);case"value":return i===a?$(this).val():($(this).each((function(){"object"==typeof i&&null!==i?(i.opacity!==a&&$(this).attr("data-opacity",k(i.opacity,0,1)),i.color&&$(this).val(i.color)):$(this).val(i),b($(this))})),$(this));default:return"create"!==t&&(i=t),$(this).each((function(){!function(t,i){var o,s,n,c,e,l,f,u=$('<div class="tfminicolors" />'),g=$.tfminicolors.defaults;if(t.data("tfminicolors-initialized"))return;i=$.extend(!0,{},g,i),u.addClass("tfminicolors-theme-"+i.theme).addClass(i.opacity?"tfminicolors-with-opacity":"tfminicolors-without-opacity"),i.position!==a&&$.each(i.position.split(" "),(function(){u.addClass("tfminicolors-position-"+this)}));s="rgb"===i.format?i.opacity?"25":"20":i.keywords?"11":"7";t.addClass("tfminicolors-input").data("tfminicolors-initialized",!1).data("tfminicolors-settings",i).prop("size",s).attr({autocomplete:"off",placeholder:" "}).wrap(u).after('<div class="tfminicolors-panel tfminicolors-slider-'+i.control+'"><div class="tfminicolors-slider tfminicolors-sprite"><div class="tfminicolors-picker"></div></div><div class="tfminicolors-opacity-slider tfminicolors-sprite"><div class="tfminicolors-picker"></div></div><div class="tfminicolors-grid tfminicolors-sprite"><div class="tfminicolors-grid-inner tf_abs tf_w tf_h"></div><div class="tfminicolors-picker"><div></div></div></div></div>'),i.inline||t.after('<span class="tfminicolors-swatch tfminicolors-input-swatch"><span class="tfminicolors-swatch-color tf_abs"></span></span>');t.after('<div class="tfminicolors_clear_btn tf_close"></div>'),t.on("focus.tfminicolors blur.tfminicolors keydown.tfminicolors keyup.tfminicolors paste.tfminicolors",(i=>{var o=i.type;if("focus"!==o||t.parent().hasClass("tfminicolors-var-input"))if("blur"===o){const i=t.data("tfminicolors-settings");let o,s,n,r,c=t.val();if(!t.data("tfminicolors-initialized"))return;const e=i.keywords?$.map(i.keywords.split(","),(t=>t.toLowerCase().trim())):[];""!==c&&(0===c.indexOf("--")||e.indexOf(c.toLowerCase())>-1)?r=c:("transparent"===c&&(c="rgba(0,0,0,0)"),x(c)?s=_(c,!0):(o=y(c,!0),s=o?F(o):null),r=null===s?i.defaultValue:"rgb"===i.format?_(i.opacity?"rgba("+s.r+","+s.g+","+s.b+","+t.attr("data-opacity")+")":"rgb("+s.r+","+s.g+","+s.b+")"):S(s)),n=i.opacity?t.attr("data-opacity"):1,"transparent"===r.toLowerCase()&&(n=0),t.closest(".tfminicolors").find(".tfminicolors-input-swatch > span").css("opacity",n),t.val(r),""===c&&t.val(v(i.defaultValue,!0)),t.val(w(c,i.letterCase))}else if("keydown"===o)switch(i.which){case 9:m();break;case 13:case 27:m(),t.blur();break}else"keyup"!==o&&"paste"!==o||("keyup"===o?b(t,!0):r((()=>{b(t,!0)}),1));else p(t)}));const k=t.closest(".tfminicolors");if(k.on("click.tfminicolors",".tfminicolors-swatches li",(function(t){t.preventDefault();var i=$(this),o=i.parents(".tfminicolors").find(".tfminicolors-input"),s=i.data("swatch-color");d(o,s,C(s)),b(o)})).find(".tfminicolors-input-swatch").on("click mousedown.tfminicolors touchstart.tfminicolors",(o=>{if("click"===o.type)i.inline||t.focus();else{if(1!==o.which)return;p(t)}o.preventDefault()})),k[0].addEventListener("pointerdown",(t=>{if(1===t.which){const i=t.target.closest(".tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider");if(i){const o=$(i),s=t=>{h(o,t)};h(o,t,!0),i.addEventListener("pointermove",s,{passive:!0}),i.addEventListener("lostpointercapture",(function(){this.removeEventListener("pointermove",s,{passive:!0})}),{passive:!0,once:!0}),i.setPointerCapture(t.pointerId)}}}),{passive:!0}),k[0].getElementsByClassName("tfminicolors_clear_btn")[0].addEventListener("click",(i=>{i.stopPropagation(),d(t,"",1)}),{passive:!0}),(l=t.parent().find(".tfminicolors-panel")).on("selectstart",(()=>!1)).end(),i.swatches&&0!==i.swatches.length)for(l.addClass("tfminicolors-with-swatches"),n=$('<ul class="tfminicolors-swatches tf_scrollbar"></ul>').appendTo(l),f=0;f<i.swatches.length;++f)"object"==typeof i.swatches[f]?(o=i.swatches[f].name,c=i.swatches[f].color):(o="",c=i.swatches[f]),e=c,c=x(c)?_(c,!0):F(y(c,!0)),$('<li class="tfminicolors-swatch"><span class="tfminicolors-swatch-color tf_abs" title="'+o+'"></span></li>').appendTo(n).data("swatch-color",e).find(".tfminicolors-swatch-color").css({backgroundColor:S(c),opacity:c.a}),i.swatches[f]=c;i.inline&&t.parent().addClass("tfminicolors-inline");b(t,!1),t.data("tfminicolors-initialized",!0)}($(this),i)})),$(this)}}}),i.themifyColorManager={colorSwatches:{},initilized:!1,init(){if(!this.initilized&&i.themifyCM!==a){this.initilized=!0;for(let t=c.keys(l.colors),i=0,o=t.length;i<o;++i)this.colorSwatches[t[i]]=l.colors[t[i]]}},toRgba:t=>t.color.replace("rgb","rgba").replace(")",","+t.opacity+")"),toColorsArray(){let t=[];for(let i=c.keys(this.colorSwatches),o=i.length-1;o>-1;--o)t.push(this.toRgba(this.colorSwatches[i[o]]));return t.length||(t=["#FFF"]),t},initColorPicker(t){const i=t.closest(".tfminicolors").querySelector(".tfminicolors-focus .tfminicolors-panel");if(i.getElementsByClassName("tf_swatches_container")[0])return;const s=o.createElement("div"),n=s.getElementsByClassName("tfminicolors-swatch"),r=c.keys(this.colorSwatches).reverse(),e=o.createElement("div"),a=o.createElement("span"),f=o.createElement("span"),p=o.createElement("div");s.className="tf_swatches_container",s.addEventListener("click",this.initClick.bind(this)),s.appendChild(i.getElementsByClassName("tfminicolors-swatches")[0]);for(let t=n.length-1;t>-1;--t){if(!r.length){n[t].parentNode.removeChild(n[t]);break}let i=o.createElement("span"),s=this.colorSwatches[r[t]].uid||this.UID()+t;i.className="tf_delete_swatch tf_close",n[t].appendChild(i),n[t].dataset.uid=this.colorSwatches[r[t]].uid=s}f.className=a.className="tf_cm_tooltip",a.innerText=l.i18n.save,e.appendChild(a),e.className="tf_add_swatch tf_plus_icon",e.setAttribute("tabIndex","-1"),s.appendChild(e),f.innerText=l.i18n.ie,p.className="tf_cm_dropdown_icon",p.setAttribute("tabIndex","-1"),p.append(f,this.getIcon("ti-import"),this.makeImportExportDropdown()),s.appendChild(p),i.appendChild(s)},makeImportExportDropdown(){const t=o.createElement("div"),i=o.createElement("ul"),s=o.createElement("li"),n=o.createElement("li");return t.className="tf_cm_dropdown",s.className="tb_cm_import",s.append(this.getIcon("ti-import"),o.createTextNode(l.i18n.import.label)),n.className="tb_cm_export",n.append(this.getIcon("ti-export"),o.createTextNode(l.i18n.export)),i.append(s,n),t.appendChild(i),t},getIcon(t,i){t="tf-"+t.trim().replace(" ","-");const s="http://www.w3.org/2000/svg",n=o.createElementNS(s,"use"),r=o.createElementNS(s,"svg");let c="tf_fa "+t;return i&&(c+=" "+i),r.setAttribute("class",c),n.setAttributeNS(null,"href","#"+t),r.appendChild(n),r},UID:()=>(e.random().toString(36).substring(2)+(new Date).getTime().toString(36)).substring(0,5),initClick(t){t.preventDefault();const i=t.target,o=i.classList;o.contains("tf_delete_swatch")?this.deleteSwatch(t):o.contains("tf_add_swatch")?this.addSwatch(i.ownerDocument):o.contains("tb_cm_export")?(i.parentNode.parentNode.parentNode.blur(),this.exportColors("colors")):o.contains("tb_cm_import")&&(i.parentNode.parentNode.parentNode.blur(),this.importColors("colors",i.ownerDocument))},loadJSZip:()=>t.loadJs("https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",!!window.JSZip,!1),async exportColors(t){const i=(t,i)=>{let s=o.createElement("a");s.download=t,s.rel="noopener",s.href=URL.createObjectURL(i),r((()=>{URL.revokeObjectURL(s.href),s=null}),7e3),s.click()};let s="gradients"===t?l.gradients:this.colorSwatches;s=JSON.stringify(s);try{await this.loadJSZip();const o=new JSZip;o.file(t+".txt",s),i("themify_"+t+"_export.zip",await o.generateAsync({type:"blob"}))}catch(o){i("themify_"+t+"_export.txt",new Blob([s],{type:"text/plain"}))}},async importColors(s,n){n=n||o,await t.loadJs(t.url+"js/admin/notification",!!i.TF_Notification);const r=this,e=l.i18n.import,a=n.createElement("input");a.type="file",a.accept=".zip,.txt",a.tfOn("change",(async i=>{TF_Notification.show("info",e.go),i.currentTarget.remove();try{const n=i.currentTarget.files[0],a=i=>{t.fetch({action:"themify_import_colors",type:s,nonce:l.nonce,data:i}).then((t=>{if(!t.success)throw Error(e.fail);if(TF_Notification.showHide(),"colors"===s){r.colorSwatches=t.data;for(let t=o.querySelectorAll(".tf_swatches_container .tfminicolors-swatch"),i=t.length-1;i>-1;--i)t[i].parentNode.removeChild(t[i]);for(let t=c.keys(r.colorSwatches),i=0;i<t.length;i++)r.addSwatchHtml(o,r.colorSwatches[t[i]].color,r.colorSwatches[t[i]].opacity,t[i])}else if("gradients"===s){const i=$(tb_app.LightBox.el.querySelector(".tb_gradient_container")).data("themifyGradient");for(let t=c.keys(l.gradients),o=t.length-1;o>-1;--o)i.removeSwatch(t[o]);l.gradients=t.data;for(let t=c.keys(l.gradients),o=0;o<t.length;++o)i.addSwatch(l.gradients[t[o]])}}))};if("text/plain"===n.type){(new FileReader).tfOn("loadend",(function(t){try{this.readyState===FileReader.DONE&&a(t.target.result)}catch(t){}}),{passive:!0,once:!0}).readAsText(n)}else{if("application/x-zip-compressed"!==n.type&&"application/zip"!==n.type)throw Error(e.invalid);{await this.loadJSZip();const t=new JSZip,i=await t.loadAsync(n),o=i.files;if(!o?.[s+".txt"])throw Error(e.invalid);const r=await i.file(s+".txt").async("text");a(r)}}}catch(i){TF_Notification.showHide("error",i.message)}}),{passive:!0,once:!0}).click()},deleteSwatch(t){t.preventDefault(),t.stopPropagation();const i=t.target.parentNode.dataset.uid;for(let o=t.target.ownerDocument.querySelectorAll('[data-uid="'+i+'"]'),s=o.length-1;s>-1;--s)o[s].parentNode.removeChild(o[s]);delete this.colorSwatches[i],this.updateColorSwatches("colors")},updateColorSwatches(t){$.ajax({type:"POST",url:l.ajax_url,dataType:"json",data:{action:"themify_save_colors",type:t,nonce:l.nonce,colors:"colors"===t?this.colorSwatches:l.gradients}})},addSwatch(t){const i=t.querySelector(".tfminicolors-focus .tfminicolors-input"),o=i.value,s=o?S(F(o)):null,r=i.dataset.opacity;if(!s)return!1;for(let t=c.keys(this.colorSwatches),i=t.length-1;i>-1;--i)if(this.colorSwatches[t[i]].color.replace(/\s/g,"")===s&&n(this.colorSwatches[t[i]].opacity)===n(r))return!1;const e=this.UID();this.addSwatchHtml(t,s,r,e),this.colorSwatches[e]={color:s,opacity:r,uid:e},this.updateColorSwatches("colors")},addSwatchHtml(t,i,o,s){const n=s=>{const n=t.createElement("li"),r=t.createElement("span"),c=t.createElement("span");return n.className="tfminicolors-swatch tfminicolors-sprite",n.dataset.uid=s,n.dataset.swatchColor=i.replace(")",", "+o+")").replace("rgb","rgba"),r.className="tfminicolors-swatch-color tf_abs",r.style.backgroundColor=i,r.style.opacity=o,c.className="tf_delete_swatch tf_close",n.append(r,c),n};for(let i=t.querySelectorAll(".tf_swatches_container .tfminicolors-swatches"),o=i.length-1;o>-1;--o)i[o].insertBefore(n(s),i[o].firstChild)}},i.themifyColorManager.init()})(jQuery,Themify,window,document,parseInt,parseFloat,setTimeout,Object,Math,void 0,themifyCM);